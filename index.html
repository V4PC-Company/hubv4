<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CVC | Hub de Dados Integrado</title>
    
    <link rel="icon" href="https://cdn-icons-png.flaticon.com/512/906/906343.png" type="image/png">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Orbitron:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        :root {
            --bg-dark: #05020a; --sidebar-bg: #0a0414; --card-bg: rgba(20, 10, 35, 0.95);
            --cyan: #00f2ff; --magenta: #ff00e5; --purple: #7000ff; --yellow: #ffd700;
            --bant-color: #ffe600; 
            --border: rgba(0, 242, 255, 0.15); --text-main: #e0e0e0; --text-muted: #8c8c8c;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Inter', sans-serif; background-color: var(--bg-dark); color: var(--text-main); height: 100vh; display: flex; overflow: hidden; }
        
        /* SCROLLBAR */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #0a0414; }
        ::-webkit-scrollbar-thumb { background: #333; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: var(--purple); }

        /* SIDEBAR */
        .sidebar { width: 280px; background: var(--sidebar-bg); border-right: 1px solid var(--border); display: flex; flex-direction: column; padding: 20px 0; flex-shrink: 0; }
        .brand { padding: 0 20px 30px; display: flex; align-items: center; gap: 10px; font-family: 'Orbitron', sans-serif; color: var(--cyan); font-size: 1rem; letter-spacing: 1px; text-shadow: 0 0 10px rgba(0, 242, 255, 0.3); }
        
        .menu-item { padding: 14px 20px; cursor: pointer; display: flex; align-items: center; gap: 12px; color: var(--text-muted); font-size: 0.85rem; transition: 0.3s; border-left: 3px solid transparent; font-weight: 500; }
        .menu-item:hover { background: rgba(255, 255, 255, 0.03); color: #fff; }
        .menu-item.active { color: white; border-left: 3px solid var(--cyan); background: linear-gradient(90deg, rgba(0, 242, 255, 0.1) 0%, transparent 100%); text-shadow: 0 0 8px rgba(255,255,255,0.5); }
        
        .submenu { padding-left: 48px; font-size: 0.8rem; color: #666; position: relative; }
        .submenu::before { content: ''; position: absolute; left: 28px; top: 50%; width: 10px; height: 1px; background: #444; }
        .submenu:hover { color: #fff; }
        .submenu.active { color: var(--cyan); border-left: 3px solid transparent; background: transparent; text-shadow: none; }
        .submenu.active::after { content: '‚óè'; position: absolute; right: 20px; font-size: 0.6rem; color: var(--cyan); }

        .database-btn { margin-top: auto; padding: 20px; background: rgba(255, 0, 229, 0.05); border-top: 1px solid var(--border); cursor: pointer; transition: 0.3s; }
        .database-btn:hover { background: rgba(255, 0, 229, 0.15); }
        .database-btn.active { border-left: 3px solid var(--magenta); color: var(--magenta); }
        
        /* MAIN */
        .main-content { flex: 1; overflow-y: auto; padding: 30px; background: radial-gradient(circle at 10% 10%, #100520 0%, #05020a 100%); display: flex; flex-direction: column; }
        
        .design-mode-banner { background: linear-gradient(90deg, #ff9100, #ff0055); color: white; padding: 5px 10px; font-size: 0.7rem; font-weight: bold; text-transform: uppercase; border-radius: 4px; display: inline-block; margin-bottom: 20px; width: fit-content; font-family: 'Orbitron'; letter-spacing: 1px; }

        /* FILTROS */
        .filters-container { background: var(--card-bg); border: 1px solid var(--border); padding: 15px; border-radius: 8px; margin-bottom: 20px; display: flex; gap: 15px; align-items: center; flex-wrap: wrap; box-shadow: 0 0 15px rgba(0,0,0,0.5); }
        .filter-group { display: flex; flex-direction: column; gap: 5px; flex: 1; min-width: 130px; }
        .filter-group label { font-size: 0.7rem; color: var(--cyan); text-transform: uppercase; font-weight: bold; font-family: 'Inter'; }
        
        .filter-input { background: #000; border: 1px solid var(--border); color: #fff; padding: 10px; border-radius: 4px; font-family: 'Inter', sans-serif; font-size: 0.85rem; outline: none; transition: 0.3s; }
        .filter-input:focus { border-color: var(--magenta); box-shadow: 0 0 10px rgba(255, 0, 229, 0.2); }
        input[type="date"]::-webkit-calendar-picker-indicator { filter: invert(1); cursor: pointer; }
        
        .btn-filter { height: 40px; margin-top: 18px; background: var(--purple); color: white; border: none; padding: 0 25px; border-radius: 4px; cursor: pointer; font-family: 'Orbitron', sans-serif; transition: 0.3s; }
        .btn-filter:hover { background: var(--magenta); transform: scale(1.05); }

        /* DIN√ÇMICOS */
        .dynamic-filter { display: none; min-width: 160px; }
        #group-master label { color: var(--bant-color); }
        #group-master select { border-color: var(--bant-color); color: #fff; }
        #group-year label, #group-quarter label { color: var(--yellow); }
        #group-year select, #group-quarter select { border-color: var(--yellow); color: #fff; }

        /* CARDS & TABLES */
        .view-section { display: none; animation: fadeIn 0.4s ease; width: 100%; }
        .view-section.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }
        
        .card { background: var(--card-bg); border: 1px solid var(--border); border-radius: 8px; margin-bottom: 25px; overflow: hidden; box-shadow: 0 0 20px rgba(0,0,0,0.4); }
        .card-header { background: rgba(15, 10, 24, 0.95); padding: 15px 20px; border-bottom: 1px solid var(--border); color: #fff; font-family: 'Inter'; font-weight: 600; font-size: 0.9rem; text-transform: uppercase; display: flex; justify-content: space-between; align-items: center; }
        
        table { width: 100%; border-collapse: collapse; font-size: 0.85rem; font-family: 'Inter'; }
        th { text-align: left; padding: 14px 20px; background: rgba(0, 0, 0, 0.6); color: var(--cyan); border-bottom: 1px solid var(--border); font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px; font-size: 0.75rem; }
        td { padding: 14px 20px; border-bottom: 1px solid rgba(255,255,255,0.05); color: #ccc; vertical-align: middle; }
        tr:hover td { background: rgba(255,255,255,0.02); color: #fff; }

        /* SUMMARY BAR */
        .summary-bar { display: flex; gap: 20px; margin-bottom: 25px; flex-wrap: wrap; }
        .summary-card { background: #000; border: 1px solid var(--border); border-radius: 8px; padding: 15px 25px; min-width: 150px; display: flex; flex-direction: column; align-items: center; box-shadow: 0 4px 10px rgba(0,0,0,0.5); position: relative; overflow: hidden; }
        .summary-card::before { content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 2px; background: linear-gradient(90deg, transparent, var(--cyan), transparent); }
        .summary-title { color: var(--text-muted); font-size: 0.75rem; text-transform: uppercase; font-weight: bold; margin-bottom: 5px; font-family: 'Inter'; letter-spacing: 0.5px; }
        .summary-value { color: #fff; font-size: 2rem; font-family: 'Orbitron'; font-weight: 700; text-shadow: 0 0 15px rgba(255, 255, 255, 0.1); }

        /* DASHBOARD OVERVIEW SPECIFIC */
        .overview-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; }
        .chart-container { padding: 20px; }
        .chart-row { display: flex; align-items: center; margin-bottom: 12px; font-size: 0.8rem; }
        .chart-label { width: 100px; color: #aaa; font-weight: 500; }
        .chart-bar-bg { flex: 1; background: #1a1a1a; height: 12px; border-radius: 6px; overflow: hidden; margin: 0 10px; }
        .chart-bar-fill { height: 100%; border-radius: 6px; transition: width 1s; }
        .chart-value { width: 40px; text-align: right; color: #fff; font-weight: bold; }
        
        /* SCALINK STYLES */
        .scalink-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
        .scalink-title { font-size: 1.8rem; font-family: 'Inter'; font-weight: bold; color: white; text-align: center; width: 100%; }
        .scalink-kpi { background: #000; border: 1px solid var(--yellow); border-radius: 6px; padding: 10px 20px; width: 120px; text-align: center; }
        .scalink-table-container { background: #000; border: 1px solid #333; margin-bottom: 20px; border-radius: 4px; overflow: hidden; }
        .scalink-table th { background: #000; color: var(--yellow); border-bottom: 1px solid #333; font-size: 0.7rem; padding: 10px; text-align: center; }
        .scalink-table td { text-align: center; padding: 8px; font-size: 0.8rem; border-bottom: 1px solid #222; }
        .scalink-row-inactive { background: #8b0000; color: white; }
        .scalink-row-active { background: #2e7d32; color: white; }
        .scalink-row-total { background: #000; color: white; font-weight: bold; }
        .scalink-split-view { display: flex; gap: 20px; height: 500px; }
        .scalink-col { flex: 1; background: #000; border: 1px solid #333; border-radius: 4px; display: flex; flex-direction: column; }
        
        /* TAGS */
        .tag-source { font-size: 0.65rem; padding: 4px 10px; border-radius: 4px; text-transform: uppercase; font-weight: 700; margin-right: 8px; display: inline-block; min-width: 50px; text-align: center; letter-spacing: 0.5px; box-shadow: 0 0 5px rgba(0,0,0,0.3); }
        .tag-jul { border: 1px solid #ff0055; color: #ff0055; background: rgba(255, 0, 85, 0.05); }
        .tag-ago { border: 1px solid #ff9100; color: #ff9100; background: rgba(255, 145, 0, 0.05); }
        .tag-set { border: 1px solid #ff00e5; color: #ff00e5; background: rgba(255, 0, 229, 0.05); }
        .tag-out { border: 1px solid #00f2ff; color: #00f2ff; background: rgba(0, 242, 255, 0.05); }
        .tag-nov { border: 1px solid #7000ff; color: #7000ff; background: rgba(112, 0, 255, 0.05); }
        .tag-dez { border: 1px solid #00ff88; color: #00ff88; background: rgba(0, 255, 136, 0.05); }
        .tag-acao { border: 1px solid #ffd700; color: #ffd700; background: rgba(255, 215, 0, 0.05); }
        .tag-ind { border: 1px solid #fff; color: #fff; background: rgba(255, 255, 255, 0.05); }
        .tag-bant { border: 1px solid var(--bant-color); color: var(--bant-color); background: rgba(255, 230, 0, 0.05); }
        .tag-conv { border: 1px solid var(--yellow); color: var(--yellow); background: rgba(255, 215, 0, 0.05); }
        .tag-sca { border: 1px solid #fff; color: #fff; background: #222; }

        .status-badge { padding: 4px 8px; border-radius: 4px; font-size: 0.75rem; font-weight: 600; display: inline-block; }
        .st-ativo { color: #00ff88; background: rgba(0, 255, 136, 0.1); border: 1px solid rgba(0, 255, 136, 0.2); }
        .st-inativo { color: #ff4d4d; background: rgba(255, 77, 77, 0.1); border: 1px solid rgba(255, 77, 77, 0.2); }
        .st-negocia { color: #ffd700; background: rgba(255, 215, 0, 0.1); border: 1px solid rgba(255, 215, 0, 0.2); }
        .st-bant { color: var(--bant-color); background: rgba(255, 230, 0, 0.1); border: 1px solid rgba(255, 230, 0, 0.2); font-weight: bold; }

    </style>
</head>
<body>

    <aside class="sidebar">
        <div class="brand"><i class="fas fa-chart-line"></i> V4 | SCALINK</div>
        
        <div class="menu-item active" onclick="switchTab('page-overview', this)">
            <i class="fas fa-home"></i> VIS√ÉO GERAL
        </div>

        <div class="menu-item" onclick="switchTab('page1', this)">
            <i class="fas fa-layer-group"></i> LEADS GERAIS V4
        </div>
        <div class="menu-item submenu" onclick="switchTab('page2', this)">
            A√ß√µes Especiais
        </div>
        <div class="menu-item submenu" onclick="switchTab('page3', this)">
            Ag√™ncias Individuais
        </div>
        
        <div class="menu-item" onclick="switchTab('page-bant4', this)" style="border-top: 1px solid rgba(255,255,255,0.05);">
            <i class="fas fa-bullseye" style="color: var(--bant-color)"></i> LEADS BANT 4
        </div>

        <div class="menu-item" onclick="switchTab('page-converted', this)">
            <i class="fas fa-check-circle" style="color: var(--yellow)"></i> LEADS CONVERTIDOS
        </div>

        <div class="menu-item" onclick="switchTab('page-scalink', this)">
            <i class="fas fa-chart-pie" style="color: #fff"></i> LEADS TOTAIS SCALINK
        </div>

        <div class="database-btn" onclick="switchTab('page-master', this)">
            <div style="font-family: 'Orbitron'; font-weight: bold; color: var(--magenta); display: flex; align-items: center; gap: 10px;">
                <i class="fas fa-database"></i> BASE GERAL
            </div>
            <div style="font-size: 0.7rem; color: #666; margin-top: 5px;">Vis√£o Consolidada (Full)</div>
        </div>
    </aside>

    <main class="main-content">
        
        <div class="design-mode-banner">
            <i class="fas fa-paint-brush"></i> MODO DESIGN: DADOS FICT√çCIOS
        </div>

        <div class="filters-container">
            <div class="filter-group">
                <label>Data In√≠cio</label>
                <input type="date" id="inputDateStart" class="filter-input" min="2000-01-01" max="2050-12-31">
            </div>
            <div class="filter-group">
                <label>Data Fim</label>
                <input type="date" id="inputDateEnd" class="filter-input" min="2000-01-01" max="2050-12-31">
            </div>

            <div class="filter-group" style="flex: 2;">
                <label>Buscar (Global)</label>
                <input type="text" id="inputSearch" class="filter-input" placeholder="Nome, email, cliente...">
            </div>

            <div class="filter-group dynamic-filter" id="group-master">
                <label>Master / Regi√£o</label>
                <select id="selectMaster" class="filter-input">
                    <option value="">Todos</option>
                </select>
            </div>

            <div class="filter-group dynamic-filter" id="group-year">
                <label>Ano Aprova√ß√£o</label>
                <select id="selectYear" class="filter-input">
                    <option value="">Todos</option>
                    <option value="2024">2024</option>
                    <option value="2025">2025</option>
                    <option value="2026">2026</option>
                </select>
            </div>

            <div class="filter-group dynamic-filter" id="group-quarter">
                <label>Trimestre</label>
                <select id="selectQuarter" class="filter-input">
                    <option value="">Todos</option>
                    <option value="1¬∫TRI">1¬∫ Trimestre</option>
                    <option value="2¬∫TRI">2¬∫ Trimestre</option>
                    <option value="3¬∫TRI">3¬∫ Trimestre</option>
                    <option value="4¬∫TRI">4¬∫ Trimestre</option>
                </select>
            </div>

            <div class="filter-group">
                <label>Origem</label>
                <select id="selectSource" class="filter-input">
                    <option value="">Todas</option>
                    <option value="JUL">Julho</option>
                    <option value="AGO">Agosto</option>
                    <option value="SET">Setembro</option>
                    <option value="OUT">Outubro</option>
                    <option value="NOV">Novembro</option>
                    <option value="DEZ">Dezembro</option>
                    <option value="BANT4">BANT 4</option>
                    <option value="CONVERTED">Convertidos</option>
                    <option value="SCALINK">Scalink</option>
                </select>
            </div>
            <div class="filter-group">
                <label>Estado (UF)</label>
                <select id="selectUF" class="filter-input">
                    <option value="">Todos</option>
                    <option>SP</option><option>MG</option><option>RJ</option><option>BA</option><option>RS</option><option>PR</option><option>SC</option><option>PE</option><option>DF</option><option>GO</option>
                </select>
            </div>
            <div class="filter-group">
                <label>Status</label>
                <select id="selectStatus" class="filter-input">
                    <option value="">Todos</option>
                    <option value="Ativo">Ativo</option>
                    <option value="Inativo">Inativo</option>
                    <option value="Qualificado">Qualificado</option>
                    <option value="Implanta√ß√£o">Implanta√ß√£o</option>
                </select>
            </div>
            <button class="btn-filter" onclick="applyFilters()"><i class="fas fa-sync"></i></button>
        </div>

        <section id="page-overview" class="view-section active">
            <div class="summary-bar">
                <div class="summary-card" style="border-bottom: 3px solid var(--cyan);">
                    <div class="summary-title" style="color:var(--cyan)">TOTAL DE LEADS</div>
                    <div class="summary-value" id="ov-total">0</div>
                </div>
                <div class="summary-card" style="border-bottom: 3px solid #00ff88;">
                    <div class="summary-title" style="color:#00ff88">TOTAL ATIVOS</div>
                    <div class="summary-value" id="ov-active">0</div>
                </div>
                <div class="summary-card" style="border-bottom: 3px solid var(--bant-color);">
                    <div class="summary-title" style="color:var(--bant-color)">BANT QUALIFICADOS</div>
                    <div class="summary-value" id="ov-bant">0</div>
                </div>
                <div class="summary-card" style="border-bottom: 3px solid var(--yellow);">
                    <div class="summary-title" style="color:var(--yellow)">CONVERTIDOS</div>
                    <div class="summary-value" id="ov-conv">0</div>
                </div>
            </div>

            <div class="overview-grid">
                <div class="card">
                    <div class="card-header">Distribui√ß√£o por Origem</div>
                    <div class="chart-container" id="chart-origin">
                        </div>
                </div>

                <div class="card">
                    <div class="card-header">Sa√∫de da Base (Status)</div>
                    <div class="chart-container" id="chart-status">
                        </div>
                </div>
            </div>
        </section>

        <section id="page1" class="view-section">
            <div class="summary-bar">
                <div class="summary-card">
                    <div class="summary-title">Total de Leads</div>
                    <div class="summary-value" id="kpi-p1-total">0</div>
                </div>
                <div class="summary-card" style="border-bottom: 2px solid #00ff88;">
                    <div class="summary-title" style="color:#00ff88">Ativos / Implanta√ß√£o</div>
                    <div class="summary-value" id="kpi-p1-ativos">0</div>
                </div>
                <div class="summary-card" style="border-bottom: 2px solid #ff4d4d;">
                    <div class="summary-title" style="color:#ff4d4d">Perdidos / Inativos</div>
                    <div class="summary-value" id="kpi-p1-inativos">0</div>
                </div>
            </div>
            <div class="card">
                <div class="card-header">
                    <span>Base Semestral (Julho a Dezembro)</span>
                    <i class="fas fa-table" style="color:var(--cyan)"></i>
                </div>
                <div class="table-responsive">
                    <table>
                        <thead><tr><th>M√™s</th><th>Nome Completo</th><th>Email</th><th>Localiza√ß√£o</th><th>Status</th></tr></thead>
                        <tbody id="table-body-p1"></tbody>
                    </table>
                </div>
            </div>
        </section>

        <section id="page2" class="view-section">
            <div class="summary-bar">
                <div class="summary-card">
                    <div class="summary-title">Total de Leads</div>
                    <div class="summary-value" id="kpi-p2-total">0</div>
                </div>
                <div class="summary-card" style="border-bottom: 2px solid #00ff88;">
                    <div class="summary-title" style="color:#00ff88">Ativos</div>
                    <div class="summary-value" id="kpi-p2-ativos">0</div>
                </div>
                <div class="summary-card" style="border-bottom: 2px solid #ff4d4d;">
                    <div class="summary-title" style="color:#ff4d4d">Inativos</div>
                    <div class="summary-value" id="kpi-p2-inativos">0</div>
                </div>
            </div>
            <div class="card">
                <div class="card-header">
                    <span>Campanha Fim de Ano 2025</span>
                    <i class="fas fa-bolt" style="color:var(--yellow)"></i>
                </div>
                <div class="table-responsive">
                    <table>
                        <thead><tr><th>Origem</th><th>Nome</th><th>Email</th><th>Telefone</th><th>Regi√£o</th><th>Status</th></tr></thead>
                        <tbody id="table-body-p2"></tbody>
                    </table>
                </div>
            </div>
        </section>

        <section id="page3" class="view-section">
            <div class="summary-bar">
                <div class="summary-card">
                    <div class="summary-title">Total de Leads</div>
                    <div class="summary-value" id="kpi-p3-total">0</div>
                </div>
                <div class="summary-card" style="border-bottom: 2px solid #00ff88;">
                    <div class="summary-title" style="color:#00ff88">Ativos</div>
                    <div class="summary-value" id="kpi-p3-ativos">0</div>
                </div>
                <div class="summary-card" style="border-bottom: 2px solid #ff4d4d;">
                    <div class="summary-title" style="color:#ff4d4d">Inativos</div>
                    <div class="summary-value" id="kpi-p3-inativos">0</div>
                </div>
            </div>
            <div class="card">
                <div class="card-header">
                    <span>Leads Ag√™ncias Individuais</span>
                    <i class="fas fa-users" style="color:var(--purple)"></i>
                </div>
                <div class="table-responsive">
                    <table>
                        <thead><tr><th>Origem</th><th>Nome</th><th>Email</th><th>Cidade/UF</th><th>Status</th></tr></thead>
                        <tbody id="table-body-p3"></tbody>
                    </table>
                </div>
            </div>
        </section>

        <section id="page-bant4" class="view-section">
            <div class="summary-bar">
                <div class="summary-card" style="border: 1px solid var(--bant-color);">
                    <div class="summary-title" style="color: var(--bant-color)">LEADS TOTAIS BANT 4</div>
                    <div class="summary-value" id="kpi-bant4-total" style="color: #fff">0</div>
                </div>
            </div>
            
            <div class="card" style="border-color: var(--bant-color);">
                <div class="card-header" style="border-bottom-color: var(--bant-color);">
                    <span style="color: var(--bant-color)">LEADS TOTAIS BANT 4</span>
                    <i class="fas fa-bullseye" style="color:var(--bant-color)"></i>
                </div>
                <div class="table-responsive">
                    <table>
                        <thead>
                            <tr>
                                <th style="color: var(--bant-color)">Cliente</th>
                                <th style="color: var(--bant-color)">Master / Regi√£o</th>
                                <th style="color: var(--bant-color)">Telefone</th>
                                <th style="color: var(--bant-color)">Origem do Lead</th>
                                <th style="color: var(--bant-color)">Motivo Encerramento</th>
                                <th style="color: var(--bant-color)">Criado Em</th>
                                <th style="color: var(--bant-color)">Status</th>
                            </tr>
                        </thead>
                        <tbody id="table-body-bant4"></tbody>
                    </table>
                </div>
            </div>
        </section>

        <section id="page-converted" class="view-section">
            <div class="summary-bar">
                <div class="summary-card" style="border: 1px solid var(--yellow);">
                    <div class="summary-title" style="color: var(--yellow)">TOTAL CONVERTIDOS</div>
                    <div class="summary-value" id="kpi-conv-total" style="color: #fff">0</div>
                </div>
            </div>
            
            <div class="card" style="border-color: var(--yellow);">
                <div class="card-header" style="border-bottom-color: var(--yellow);">
                    <span style="color: var(--yellow)">Leads Convertidos | V4 PLACERES & CO</span>
                    <i class="fas fa-check-circle" style="color:var(--yellow)"></i>
                </div>
                <div class="table-responsive">
                    <table>
                        <thead>
                            <tr>
                                <th style="color: var(--yellow)">Nome Loja</th>
                                <th style="color: var(--yellow)">Ano Aprova√ß√£o</th>
                                <th style="color: var(--yellow)">Trimestre</th>
                                <th style="color: var(--yellow)">Status</th>
                                <th style="color: var(--yellow)">Nome Franqueado</th>
                                <th style="color: var(--yellow)">Email Franqueado</th>
                            </tr>
                        </thead>
                        <tbody id="table-body-converted"></tbody>
                    </table>
                </div>
            </div>
        </section>

        <section id="page-scalink" class="view-section">
            <div class="scalink-header">
                <div style="display:flex; align-items:center;">
                    <div class="scalink-kpi">
                        <div class="scalink-kpi-title">Leads Totais</div>
                        <div class="scalink-kpi-val" id="kpi-sca-total">0</div>
                    </div>
                </div>
                <div class="scalink-title">Leads Totais Scalink</div>
                <div style="font-family:'Orbitron'; font-weight:bold; font-size:1.2rem; color:#fff;">
                    <i class="fas fa-cube"></i> Placeres <span style="font-size:0.8rem">&Co</span>
                </div>
            </div>

            <div class="scalink-table-container">
                <table class="scalink-table">
                    <thead>
                        <tr>
                            <th>Situa√ß√£o Cadastro</th>
                            <th>Lead</th>
                            <th>Reuni√£o</th>
                            <th>Contato Ini...</th>
                            <th>null</th>
                            <th>Defini√ß√£o P...</th>
                            <th>Comit√™ Exp...</th>
                            <th>Lead Multi...</th>
                            <th>Franq...</th>
                            <th style="background:#000; color:#fff;">Total ge...</th>
                        </tr>
                    </thead>
                    <tbody id="scalink-funnel-body"></tbody>
                </table>
            </div>

            <div class="scalink-split-view">
                <div class="scalink-col">
                    <div class="scalink-col-header" style="display:flex; justify-content:space-between; text-align:left;">
                        <span>Nome</span> <span>Email</span> <span style="color:var(--yellow)">Estado...</span>
                    </div>
                    <div style="overflow-y:auto; flex:1;">
                        <table style="width:100%;">
                            <tbody id="scalink-list-body"></tbody>
                        </table>
                    </div>
                    <div style="padding:10px; text-align:right; font-size:0.7rem; color:#666; border-top:1px solid #222;">
                        1 - 100 / <span id="sca-list-count">0</span>
                    </div>
                </div>

                <div class="scalink-col">
                    <div class="scalink-col-header">Situa√ß√£o Cadastro / Nome</div>
                    <div style="display:flex; justify-content:space-between; padding:10px; font-size:0.7rem; color:#999;">
                        <span>Estado de Intere...</span>
                        <span>Ativo / Inativo</span>
                    </div>
                    <div style="overflow-y:auto; flex:1;" id="scalink-chart-body"></div>
                </div>
            </div>
        </section>

        <section id="page-master" class="view-section">
            <div class="summary-bar">
                <div class="summary-card" style="border: 1px solid var(--magenta);">
                    <div class="summary-title" style="color:var(--magenta)">REGISTROS TOTAIS (FULL DB)</div>
                    <div class="summary-value" id="kpi-master-total">0</div>
                </div>
            </div>
            <div class="card">
                <div class="card-header">
                    <span>Master Database (Vis√£o Unificada)</span>
                    <i class="fas fa-database" style="color:var(--magenta)"></i>
                </div>
                <div class="table-responsive">
                    <table>
                        <thead><tr><th>Origem</th><th>Nome / Cliente</th><th>Local / Regi√£o</th><th>Email / Contato</th><th>Status</th></tr></thead>
                        <tbody id="table-body-master"></tbody>
                    </table>
                </div>
            </div>
        </section>

    </main>

    <script>
        // LISTA COMPLETA
        const MASTERS_LIST = [
            "Milene Cristina Bartolli", "Kerolayne Viana", "Ariane Luz da Rocha", "Frederico Omar Castel...",
            "MG - Julio C. Machado", "Julio C. Machado", "Helio Gomes Cruz Ra...", "Eug√™nio Monteiro",
            "Grupo Expans√£o RJ", "Marcela Monteiro", "PA / MA ‚Äì Luiz Walter", "AM / RO - Marcio Bar...",
            "ES - Serguey Junior", "SP-VP-Osasco ‚Äì Carl...", "AC - Junior Lavor", "GO - Frederico Oma...",
            "SC - Vanderli Comin...", "RJ - Grupo Expans√£o...", "PR - Grupo Expans√£o...", "MS ‚Äì Ot√°vio Pazin",
            "RS ‚Äì Grupo Expans√£o...", "BA - Marcela Montei...", "MT - Carlos Wolff", "SP Interior - Bruno G..."
        ];

        let masterDB = [];

        window.onload = () => {
            generateMockData();
            populateMasterSelect();
            applyFilters();
        };

        function generateMockData() {
            const sources = ['JUL', 'AGO', 'SET', 'OUT', 'NOV', 'DEZ'];
            const statuses = ['Ativo', 'Inativo', 'Em Negocia√ß√£o', 'Implanta√ß√£o', 'Perdido'];
            const ufs = ['SP', 'RJ', 'MG', 'RS', 'BA', 'SC', 'PE', 'PR'];
            
            const randomDate = (year) => {
                const m = Math.floor(Math.random()*12)+1;
                const d = Math.floor(Math.random()*28)+1;
                return `${year}-${String(m).padStart(2,'0')}-${String(d).padStart(2,'0')}`;
            };

            // MOCK DATA GENERATION (Mesmo das vers√µes anteriores)
            // 1. GERAIS
            for(let i=0; i<150; i++) {
                masterDB.push({
                    source: sources[Math.floor(Math.random() * sources.length)],
                    name: `Cliente V4 Exemplo ${i+1}`,
                    email: `contato${i+1}@empresa.com`,
                    phone: `(11) 99999-${1000 + i}`,
                    city: 'S√£o Paulo', 
                    uf: ufs[Math.floor(Math.random() * ufs.length)],
                    status: statuses[Math.floor(Math.random() * statuses.length)],
                    createdAt: randomDate(2024)
                });
            }
            // 2. A√á√ÉO
            for(let i=0; i<30; i++) {
                masterDB.push({
                    source: 'ACAO',
                    name: `Lead Campanha ${i+1}`,
                    email: `lead${i+1}@gmail.com`,
                    phone: `(21) 98888-${2000 + i}`,
                    city: 'Rio de Janeiro',
                    uf: 'RJ',
                    status: Math.random() > 0.3 ? 'Ativo' : 'Inativo',
                    createdAt: randomDate(2025)
                });
            }
            // 3. INDIVIDUAIS
            for(let i=0; i<20; i++) {
                masterDB.push({
                    source: 'IND',
                    name: `Ag√™ncia Parceira ${i+1}`,
                    email: `parceiro${i+1}@agencia.com`,
                    phone: `(31) 97777-${3000 + i}`,
                    city: 'Belo Horizonte',
                    uf: 'MG',
                    status: Math.random() > 0.5 ? 'Ativo' : 'Inativo',
                    createdAt: randomDate(2024)
                });
            }
            // 4. BANT 4
            for(let i=0; i<50; i++) {
                const rDate = randomDate(2025);
                masterDB.push({
                    source: 'BANT4',
                    name: `Lead BANT4 ${i+1}`,
                    email: `bant${i+1}@lead.com`, 
                    phone: `(11) 9...`,
                    region: MASTERS_LIST[Math.floor(Math.random() * MASTERS_LIST.length)], 
                    origin: 'LP Comparativo v4',
                    reason: 'Qualificado BANT4 üöÄ',
                    status: Math.random() > 0.8 ? 'Lead n√£o responde' : 'null',
                    city: '-', uf: '-',
                    createdAt: rDate,
                    displayDate: formatDatePtBR(rDate)
                });
            }
            // 5. CONVERTIDOS
            const stores = ['√ÅGUAS LINDAS SHOPPING', 'VITORIA DE SANTO ANT√ÉO', 'VAZANTE', 'TAQUARA', 'S√ÉO JO√ÉO DA BARRA', 'STREET MALL TAPAJ√ìS', 'SHOPPING RUA DA PRAIA', 'SETOR CAMPINAS', 'FORMIGA'];
            const quarters = ['1¬∫TRI', '2¬∫TRI', '3¬∫TRI', '4¬∫TRI'];
            for(let i=0; i<40; i++) {
                const year = Math.random() > 0.5 ? '2024' : '2025';
                masterDB.push({
                    source: 'CONVERTED',
                    name: stores[Math.floor(Math.random() * stores.length)],
                    year: year,
                    quarter: quarters[Math.floor(Math.random() * quarters.length)],
                    status: Math.random() > 0.3 ? 'Implanta√ß√£o' : 'Declinou',
                    franchisee: `Franqueado ${i+1}`,
                    email: `franqueado${i+1}@email.com`,
                    city: '-', uf: '-', phone: '-',
                    createdAt: randomDate(parseInt(year))
                });
            }
            // 6. SCALINK
            const scaStages = ['Lead', 'Reuni√£o', 'Contato Inicial', 'null', 'Defini√ß√£o P...', 'Comit√™ Exp...', 'Lead Multi...', 'Franq...'];
            for(let i=0; i<100; i++) {
                masterDB.push({
                    source: 'SCALINK',
                    name: `Scalink Lead ${i+1}`,
                    email: `scalink${i+1}@test.com`,
                    status: Math.random() > 0.1 ? 'Ativo' : 'Inativo',
                    stage: scaStages[Math.floor(Math.random() * scaStages.length)],
                    uf: ufs[Math.floor(Math.random() * ufs.length)],
                    city: 'Capital',
                    createdAt: randomDate(2026)
                });
            }
        }

        function populateMasterSelect() {
            const select = document.getElementById('selectMaster');
            MASTERS_LIST.forEach(m => {
                const opt = document.createElement('option');
                opt.value = m;
                opt.innerText = m;
                select.appendChild(opt);
            });
        }

        function formatDatePtBR(isoDate) {
            if(!isoDate) return '-';
            const [y, m, d] = isoDate.split('-');
            const months = ['jan','fev','mar','abr','mai','jun','jul','ago','set','out','nov','dez'];
            return `${d} de ${months[parseInt(m)-1]}. de ${y}`;
        }

        function switchTab(pageId, btn) {
            document.querySelectorAll('.view-section').forEach(el => el.classList.remove('active'));
            document.getElementById(pageId).classList.add('active');
            
            document.querySelectorAll('.menu-item').forEach(el => el.classList.remove('active'));
            document.querySelectorAll('.submenu').forEach(el => el.classList.remove('active'));
            document.querySelector('.database-btn').classList.remove('active');
            
            if (btn.classList.contains('menu-item') || btn.classList.contains('submenu')) btn.classList.add('active');
            else btn.classList.add('active');

            const masterGroup = document.getElementById('group-master');
            const yearGroup = document.getElementById('group-year');
            const quarterGroup = document.getElementById('group-quarter');
            masterGroup.style.display = 'none';
            yearGroup.style.display = 'none';
            quarterGroup.style.display = 'none';

            if (pageId === 'page-bant4') masterGroup.style.display = 'flex';
            else if (pageId === 'page-converted') {
                yearGroup.style.display = 'flex';
                quarterGroup.style.display = 'flex';
            }
        }

        function applyFilters() {
            const search = document.getElementById('inputSearch').value.toLowerCase();
            const source = document.getElementById('selectSource').value;
            const uf = document.getElementById('selectUF').value;
            const cityFilter = document.getElementById('inputCity').value.toLowerCase();
            const statusFilter = document.getElementById('selectStatus').value.toLowerCase();
            const masterFilter = document.getElementById('selectMaster').value;
            const yearFilter = document.getElementById('selectYear').value;
            const quarterFilter = document.getElementById('selectQuarter').value;
            const dateStart = document.getElementById('inputDateStart').value;
            const dateEnd = document.getElementById('inputDateEnd').value;

            const filtered = masterDB.filter(item => {
                const isBant = item.source === 'BANT4';
                const isConv = item.source === 'CONVERTED';

                // DATA
                if(dateStart && dateEnd && item.createdAt) {
                    if(item.createdAt < dateStart || item.createdAt > dateEnd) return false;
                }

                // TEXTO
                if(!item.name.toLowerCase().includes(search) && 
                   !item.email.toLowerCase().includes(search) && 
                   !(isBant && item.region.toLowerCase().includes(search))) return false;
                
                // ORIGEM
                if(source !== "") {
                     if(source === 'SCALINK' && item.source !== 'SCALINK') return false;
                     else if(source === 'A√á√ÉO' && item.source !== 'ACAO') return false;
                     else if(source === 'IND' && item.source !== 'IND') return false;
                     else if(source === 'BANT4' && item.source !== 'BANT4') return false;
                     else if(source === 'CONVERTED' && item.source !== 'CONVERTED') return false;
                     else if(!['SCALINK','ACAO','IND','BANT4','CONVERTED'].includes(source) && item.source !== source) return false;
                }

                // UF
                if(uf !== "") {
                    if(isBant && !item.region.includes(uf)) return false;
                    else if(!isBant && !isConv && (!item.uf || item.uf.toUpperCase().trim() !== uf)) return false;
                }

                // CIDADE
                if(cityFilter !== "" && !item.city.toLowerCase().includes(cityFilter)) return false;
                
                // STATUS
                if(statusFilter !== "") {
                    let s = String(item.status).toLowerCase();
                    if(isBant && statusFilter === 'qualificado' && !item.reason.includes('Qualificado')) return false;
                    else if(!isBant || statusFilter !== 'qualificado') {
                        if(statusFilter === 'ativo' && !(s.includes('ativo') || s.includes('implanta√ß√£o'))) return false;
                        else if(statusFilter === 'inativo' && !(s.includes('inativo') || s.includes('perdido'))) return false;
                        else if(statusFilter !== 'ativo' && statusFilter !== 'inativo' && !s.includes(statusFilter)) return false;
                    }
                }

                // DIN√ÇMICOS
                if(masterFilter !== "" && isBant && item.region !== masterFilter) return false;
                if(isConv) {
                    if(yearFilter !== "" && item.year !== yearFilter) return false;
                    if(quarterFilter !== "" && item.quarter !== quarterFilter) return false;
                }

                return true;
            });

            renderViews(filtered);
            renderOverview(filtered); // Atualiza a Vis√£o Geral
        }

        // --- RENDERIZADORES ---

        function renderOverview(data) {
            // KPIs
            document.getElementById('ov-total').innerText = data.length;
            document.getElementById('ov-active').innerText = data.filter(i => String(i.status).toLowerCase().match(/ativo|implanta√ß√£o/)).length;
            document.getElementById('ov-bant').innerText = data.filter(i => i.source === 'BANT4' && i.reason.includes('Qualificado')).length;
            document.getElementById('ov-conv').innerText = data.filter(i => i.source === 'CONVERTED').length;

            // Chart Origem (Barras simples CSS)
            const counts = {};
            data.forEach(i => {
                let k = i.source;
                if(['JUL','AGO','SET','OUT','NOV','DEZ'].includes(k)) k = 'SEMESTRAL V4';
                counts[k] = (counts[k] || 0) + 1;
            });
            
            // Cores
            const colors = { 'SEMESTRAL V4': '#00f2ff', 'ACAO': '#ffd700', 'IND': '#fff', 'BANT4': '#ffe600', 'CONVERTED': '#ffa500', 'SCALINK': '#ccc' };

            const chartOrigin = document.getElementById('chart-origin');
            chartOrigin.innerHTML = Object.entries(counts).sort((a,b)=>b[1]-a[1]).map(([key, val]) => {
                const pct = (val / data.length) * 100;
                return `
                    <div class="chart-row">
                        <div class="chart-label">${key}</div>
                        <div class="chart-bar-bg">
                            <div class="chart-bar-fill" style="width:${pct}%; background:${colors[key]||'#7000ff'};"></div>
                        </div>
                        <div class="chart-value">${val}</div>
                    </div>
                `;
            }).join('');

            // Chart Status
            const stCounts = { 'Ativos': 0, 'Inativos': 0, 'Outros': 0 };
            data.forEach(i => {
                const s = String(i.status).toLowerCase();
                if(s.includes('ativo') || s.includes('implanta√ß√£o')) stCounts['Ativos']++;
                else if(s.includes('inativo') || s.includes('perdido') || s.includes('declinou')) stCounts['Inativos']++;
                else stCounts['Outros']++;
            });

            const chartStatus = document.getElementById('chart-status');
            chartStatus.innerHTML = Object.entries(stCounts).map(([key, val]) => {
                const pct = (val / data.length) * 100;
                const color = key === 'Ativos' ? '#00ff88' : (key === 'Inativos' ? '#ff4d4d' : '#888');
                return `
                    <div class="chart-row">
                        <div class="chart-label">${key}</div>
                        <div class="chart-bar-bg">
                            <div class="chart-bar-fill" style="width:${pct}%; background:${color};"></div>
                        </div>
                        <div class="chart-value">${val}</div>
                    </div>
                `;
            }).join('');
        }

        function renderViews(data) {
            // (Reutiliza a l√≥gica anterior para as outras abas)
            const p1Data = data.filter(i => ['JUL','AGO','SET','OUT','NOV','DEZ'].includes(i.source));
            renderTable('table-body-p1', p1Data, i => `<td><span class="tag-source tag-${i.source.toLowerCase()}">${i.source}</span></td><td><b>${i.name}</b></td><td>${i.email}</td><td>${i.city}/${i.uf}</td><td>${getStatusBadge(i.status)}</td>`);
            document.getElementById('kpi-p1-total').innerText = p1Data.length;
            document.getElementById('kpi-p1-ativos').innerText = p1Data.filter(i => i.status.toLowerCase().match(/ativo|implanta√ß√£o/)).length;
            document.getElementById('kpi-p1-inativos').innerText = p1Data.filter(i => i.status.toLowerCase().match(/inativo|perdido/)).length;

            const p2Data = data.filter(i => i.source === 'ACAO');
            renderTable('table-body-p2', p2Data, i => `<td><span class="tag-source tag-acao">FIM ANO</span></td><td><b>${i.name}</b></td><td>${i.email}</td><td>${i.phone}</td><td>${i.city}/${i.uf}</td><td>${getStatusBadge(i.status)}</td>`);
            document.getElementById('kpi-p2-total').innerText = p2Data.length;
            document.getElementById('kpi-p2-ativos').innerText = p2Data.filter(i => i.status.toLowerCase().includes('ativo')).length;
            document.getElementById('kpi-p2-inativos').innerText = p2Data.filter(i => i.status.toLowerCase().includes('inativo')).length;

            const p3Data = data.filter(i => i.source === 'IND');
            renderTable('table-body-p3', p3Data, i => `<td><span class="tag-source tag-ind">IND</span></td><td><b>${i.name}</b></td><td>${i.email}</td><td>${i.city}/${i.uf}</td><td>${getStatusBadge(i.status)}</td>`);
            document.getElementById('kpi-p3-total').innerText = p3Data.length;
            document.getElementById('kpi-p3-ativos').innerText = p3Data.filter(i => i.status.toLowerCase().includes('ativo')).length;
            document.getElementById('kpi-p3-inativos').innerText = p3Data.filter(i => i.status.toLowerCase().includes('inativo')).length;

            const bantData = data.filter(i => i.source === 'BANT4');
            renderTable('table-body-bant4', bantData, i => `<td>${i.name}</td><td>${i.region}</td><td>${i.phone}</td><td>${i.origin}</td><td><span class="st-bant">${i.reason}</span></td><td>${i.displayDate}</td><td>${i.status === 'null' ? '<span style="opacity:0.3">null</span>' : i.status}</td>`);
            document.getElementById('kpi-bant4-total').innerText = bantData.length;

            const convData = data.filter(i => i.source === 'CONVERTED');
            renderTable('table-body-converted', convData, i => `<td><b>${i.name}</b></td><td>${i.year}</td><td>${i.quarter}</td><td>${getStatusBadge(i.status)}</td><td>${i.franchisee}</td><td>${i.email}</td>`);
            document.getElementById('kpi-conv-total').innerText = convData.length;

            const scaData = data.filter(i => i.source === 'SCALINK');
            document.getElementById('kpi-sca-total').innerText = scaData.length;
            document.getElementById('sca-list-count').innerText = scaData.length;
            
            // Scalink Logic
            const stages = ['Lead', 'Reuni√£o', 'Contato Inicial', 'null', 'Defini√ß√£o P...', 'Comit√™ Exp...', 'Lead Multi...', 'Franq...'];
            const scaInativo = scaData.filter(i => i.status === 'Inativo');
            const scaAtivo = scaData.filter(i => i.status === 'Ativo');
            const getCounts = (dataset) => stages.map(st => dataset.filter(i => i.stage === st).length);
            const inativoCounts = getCounts(scaInativo);
            const ativoCounts = getCounts(scaAtivo);
            const totalCounts = stages.map((_, idx) => inativoCounts[idx] + ativoCounts[idx]);

            document.getElementById('scalink-funnel-body').innerHTML = `
                <tr class="scalink-row-inactive"><td style="text-align:left; padding-left:15px;">Inativo</td>${inativoCounts.map(c => `<td>${c}</td>`).join('')}<td>${scaInativo.length}</td></tr>
                <tr class="scalink-row-active"><td style="text-align:left; padding-left:15px;">Ativo</td>${ativoCounts.map(c => `<td>${c}</td>`).join('')}<td>${scaAtivo.length}</td></tr>
                <tr class="scalink-row-total"><td style="text-align:left; padding-left:15px;">Total geral</td>${totalCounts.map(c => `<td>${c}</td>`).join('')}<td>${scaData.length}</td></tr>
            `;

            document.getElementById('scalink-list-body').innerHTML = scaData.map((i, idx) => `
                <tr style="border-bottom:1px solid #222; font-size:0.75rem;"><td style="padding:10px; width:30px;">${idx+1}.</td><td>${i.name}</td><td style="color:#888;">${i.email}</td><td style="text-align:right;">${i.uf}</td></tr>
            `).join('');

            const states = {};
            scaData.forEach(i => { states[i.uf] = (states[i.uf] || 0) + 1; });
            const sortedStates = Object.entries(states).sort((a,b) => b[1] - a[1]);
            document.getElementById('scalink-chart-body').innerHTML = sortedStates.map(([uf, count]) => {
                const percent = (count / scaData.length) * 100;
                return `<div class="bar-row"><div class="bar-label">${uf}</div><div class="bar-track"><div class="bar-fill" style="width:${percent}%"></div></div><div class="bar-val">${count}</div></div>`;
            }).join('');

            renderTable('table-body-master', data, i => `<td><span class="tag-source tag-${i.source.toLowerCase().substring(0,3)}">${i.source}</span></td><td><b>${i.name}</b></td><td>${i.source === 'BANT4' ? i.region : i.city + ' - ' + i.uf}</td><td>${i.email} <br><small style="color:#666">${i.phone}</small></td><td>${getStatusBadge(i.status)}</td>`);
            document.getElementById('kpi-master-total').innerText = data.length;
        }

        function renderTable(id, data, tpl) {
            const tbody = document.getElementById(id);
            tbody.innerHTML = data.length ? "" : "<tr><td colspan='10' style='text-align:center; padding:30px; opacity:0.5;'>Nenhum registro encontrado.</td></tr>";
            data.forEach(item => { const tr = document.createElement('tr'); tr.innerHTML = tpl(item); tbody.appendChild(tr); });
        }

        function getStatusBadge(status) {
            const s = status ? status.toLowerCase() : '';
            let className = '';
            if(s.includes('ativo') || s.includes('implanta√ß√£o')) className = 'st-ativo';
            else if(s.includes('inativo') || s.includes('perdido') || s.includes('declinou')) className = 'st-inativo';
            else if(s.includes('negocia')) className = 'st-negocia';
            return `<span class="status-badge ${className}">${status}</span>`;
        }
        
        ['inputSearch', 'selectSource', 'selectUF', 'inputCity', 'selectStatus', 'selectMaster', 'selectYear', 'selectQuarter', 'inputDateStart', 'inputDateEnd'].forEach(id => {
            document.getElementById(id).addEventListener(id.includes('input') ? 'input' : 'change', applyFilters);
        });
    </script>
</body>
</html>
